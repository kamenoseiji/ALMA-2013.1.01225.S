# Column density using equivalent width
#-------- constants
k <- 1.380649e-16	# Boltzmann constant, erg K^-1
h <- 6.62607015e-27 # Planck constant, erg s
epsilon_0 <- 8.8541878128e-12 # F m^-1
h_k <- 4.799244662211e-11 # h / k (s K^-1)

ColumnFact <- function(mu, B, J, nu, T, EW){
	# mu : dipole moment (Debye)
	# B  : rotational frequency [MHz]
	# J  : lower angular momentum level
	# nu : frequency [MHz]
	# T  : excitation temperature [K]
	# EW : equivalent width = integ tau dv [km/s]
	hnu_kT <- h_k* nu* 1e6 / T	# h nu / k T
	hB_kT  <- h_k* B* 1e6 / T
	exp1 <- exp(hB_kT / 3.0)
	exp2 <- exp(hB_kT * J * (J+1))
	exp3 <- 1.0 / (exp(hnu_kT) - 1.0)
	Factor <- 3.0* k* T / (8.0* pi^3* (mu * 1.0e-18)^2 * B* 1.0e6 * (2* J + 1))
	return( Factor* exp1* exp2* exp3* EW*1e5 )
}

CO21 <- ColumnFact(0.1101, 57636, 1, 230538, 230, c(17.6, 0.5))
CO32 <- ColumnFact(0.1101, 57636, 2, 345790, 230, c(23.1, 0.5))
SO87_77 <- ColumnFact(1.535, 21523.556, 7, 214357, 230, c(0.9, 0.1))
SO55_44 <- ColumnFact(1.535, 21523.556, 4, 215221, 230, c(4.7, 0.1))
SO87_76 <- ColumnFact(1.535, 21523.556, 7, 340714, 230, c(8.1, 0.5))
SO88_77 <- ColumnFact(1.535, 21523.556, 7, 344311, 230, c(7.9, 0.5))
SO89_78 <- ColumnFact(1.535, 21523.556, 7, 346528, 230, c(11.7, 0.6))
S34O56_45 <- ColumnFact(1.535, 21102.73, 4, 215839, 230, c(0.9, 0.1))
CS76 <- ColumnFact(1.957, 24495.56, 6, 342883, 230, c(6.7, 0.3))
HC15N <- ColumnFact(2.9852, 43027.64, 3, 344200, 230, c(1.2, 0.6))
H13CN <- ColumnFact(2.9852, 43170.127, 3, 345340, 230, c(11.9, 0.5))
HCN43 <- ColumnFact(2.984, 44315.97, 3, 354505, 230, c(27.0,0.5))
HCNv2 <- ColumnFact(2.9420, 44422.42, 3, 356256, 230, c(13.0, 0.4))
HCO43 <- ColumnFact(3.888, 44594.4, 3, 356734, 230, c(15.9, 0.4))
HCOl1e <- ColumnFact(3.90, 44677.15, 3, 356549, 230, c(4.5, 0.4))
HCOl1f <- ColumnFact(3.90, 44677.15, 3, 358242, 230, c(5.3, 0.2))

fcov <- 0.17
CO32corr  <- fcov * 44 /0.1508*0.1284 # correction factor for optically thick CO32
HCN43corr <- fcov * 44                # correction factor for optically thick HCN43
H13CNcorr <- fcov * 44 /0.1508*0.0594 # correction factor for optically thick H13CN
HCO43corr <- fcov * 44 /0.1508*0.0980 # correction factor for optically thick HCO+43

ColumnFact(0.1101, 57636, 2, 345790, 230, CO32corr* c(23.1, 0.5))
ColumnFact(2.984, 44315.97, 3, 354505, 230, HCN43corr* c(27.0,0.5))
ColumnFact(2.9852, 43170.127, 3, 345340, 230, H13CNcorr* c(11.9, 0.5))
ColumnFact(3.888, 44594.4, 3, 356734, 230, HCO43corr* c(15.9, 0.4))


# CO        & $J=2-1$           & 230.538 & $0.0993 +- 0.0017$ & $1496.7 +- 1.4$ & $166.5 +- 3.4$ & $17.6 +- 0.5$ \\
#           & $J=3-2$           & 345.796 & $0.1284 +- 0.0017$ & $1494.7 +- 1.1$ & $168.8 +- 2.8$ & $23.1 +- 0.5$ \\
# 		  
# SO        & $J_N = 8_7 - 7_7$ & 214.357 & $0.0053 +- 0.0006$ & $1486.4 +- 8.2$ & $150.8 +- 19.3$& $0.9 +- 0.1$ \\
#           & $J_N = 5_5 - 4_4$ & 215.221 & $0.0303 +- 0.0006$ & $1490.5 +- 1.4$ & $147.4 +- 3.3$ & $4.7 +- 0.1$ \\
#           & $J_N = 8_7 - 7_6$ & 340.714 & $0.0417 +- 0.0017$ & $1489.2 +- 3.7$ & $182.7 +- 8.7$ & $8.1 +- 0.5$ \\
#           & $J_N = 8_8 - 7_7$ & 344.311 & $0.0526 +- 0.0024$ & $1490.5 +- 4.6$ & $141.1 +- 5.9$ & $7.9 +- 0.5$ \\
#           & $J_N = 8_9 - 7_8$ & 346.528 & $0.0551 +- 0.0018$ & $1479.4 +- 3.2$ & $200.0 +- 7.6$ & $11.7 +- 0.6$ \\
# $^{34}$SO & $J_N = 5_6 - 4_5$ & 215.839 & $0.0052 +- 0.0004$ & $1492.0 +- 5.8$ & $166.8 +- 13.8$& $0.9 +- 0.1$ \\
# 
# CS        & $J=7-6$                     & 342.883 & $0.0296 +- 0.0009$ & $1501.2 +- 3.4$ & $213.2 +- 7.9$ & $6.7 +- 0.3$ \\
# HC$^{15}$N& $J=4-3, \ v=0$              & 344.200 & $0.0081 +- 0.0043$ & $1489.7 +- 21.5$& $141.1 +- 5.9$ & $1.2 +- 0.6$ \\
# H$^{13}$CN& $J=4-3, \ v=0$              & 345.340 & $0.0594 +- 0.0016$ & $1488.2 +- 2.5$ & $187.4 +- 5.8$ & $11.9 +- 0.5$ \\
#HCN       & $J=4-3, \ v=0$              & 354.505 & $0.1508 \pm 0.0018$ & $1506.9 \pm 1.0$ & $168.3 \pm 2.4$ & $27.0 \pm 0.5$ \\
#          & $J=4-3, \ v_2=1, \ \ell=1f$ & 356.256 & $0.0803 \pm 0.0019$ & $1495.7 \pm 2.0$ & $152.6 \pm 2.9$ & $13.0 \pm 0.4$ \\
#HCO$^+$   & $J=4-3, \ v=0$              & 356.734 & $0.0980 \pm 0.0020$ & $1495.4 \pm 1.9$ & $152.6 \pm 2.9$ & $15.9 \pm 0.4$ \\
#          & $J=4-3, \ v_2=1, \ \ell=1e$ & 356.549 & $0.0274 \pm 0.0021$ & $1512.5 \pm 7.1$ & $152.6 \pm 2.9$ & $4.5 \pm 0.4$ \\
#          & $J=4-3, \ v_2=1, \ \ell=1f$ & 358.242 & $0.0303 \pm 0.0008$ & $1496.6 \pm 2.4$ & $165.1 \pm 3.9$ & $5.3 \pm 0.2$

